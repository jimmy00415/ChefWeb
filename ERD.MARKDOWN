# ChefWeb Database Design (ERD)

## Entity Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    BOOKINGS                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id                    UUID           DEFAULT uuid_generate_v4()                 â”‚
â”‚     confirmation_number   VARCHAR(20)    UNIQUE NOT NULL                            â”‚
â”‚     status               VARCHAR(30)     DEFAULT 'pending_payment'                  â”‚
â”‚     payment_status       VARCHAR(30)     DEFAULT 'unpaid'                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EVENT DETAILS                                                                        â”‚
â”‚     service_state        VARCHAR(5)      NOT NULL                                   â”‚
â”‚     city                 VARCHAR(100)    NOT NULL                                   â”‚
â”‚     event_date           DATE            NOT NULL                                   â”‚
â”‚     event_time           TIME            NOT NULL                                   â”‚
â”‚     venue_type           VARCHAR(50)                                                â”‚
â”‚     venue_address        TEXT                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GUEST DETAILS                                                                        â”‚
â”‚     num_adults           INTEGER         DEFAULT 0                                  â”‚
â”‚     num_children         INTEGER         DEFAULT 0                                  â”‚
â”‚     package              VARCHAR(20)     DEFAULT 'signature'                        â”‚
â”‚     dietary_notes        TEXT                                                       â”‚
â”‚     special_requests     TEXT                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CONTACT                                                                              â”‚
â”‚     contact_name         VARCHAR(100)    NOT NULL                                   â”‚
â”‚     contact_email        VARCHAR(255)    NOT NULL                                   â”‚
â”‚     contact_phone        VARCHAR(30)     NOT NULL                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PRICING                                                                              â”‚
â”‚     base_amount          DECIMAL(10,2)   DEFAULT 0                                  â”‚
â”‚     addons_total         DECIMAL(10,2)   DEFAULT 0                                  â”‚
â”‚     travel_fee           DECIMAL(10,2)   DEFAULT 0                                  â”‚
â”‚     subtotal             DECIMAL(10,2)   DEFAULT 0                                  â”‚
â”‚     total                DECIMAL(10,2)   DEFAULT 0                                  â”‚
â”‚     payment_option       VARCHAR(20)     DEFAULT 'later'                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ METADATA                                                                             â”‚
â”‚     agree_to_terms       BOOLEAN         DEFAULT FALSE                              â”‚
â”‚     created_at           TIMESTAMPTZ     DEFAULT NOW()                              â”‚
â”‚     updated_at           TIMESTAMPTZ     DEFAULT NOW()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â”‚ 1:N
                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    PAYMENTS                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id                    UUID           DEFAULT uuid_generate_v4()                 â”‚
â”‚     payment_intent_id     VARCHAR(100)   UNIQUE NOT NULL                            â”‚
â”‚ FK  booking_id            UUID           REFERENCES bookings(id) ON DELETE SET NULL â”‚
â”‚     amount                INTEGER        NOT NULL (in cents)                        â”‚
â”‚     currency              VARCHAR(3)     DEFAULT 'usd'                              â”‚
â”‚     status                VARCHAR(30)    DEFAULT 'requires_payment'                 â”‚
â”‚     payment_type          VARCHAR(20)    (full, deposit)                            â”‚
â”‚     stripe_customer_id    VARCHAR(100)                                              â”‚
â”‚     refund_id             VARCHAR(100)                                              â”‚
â”‚     created_at            TIMESTAMPTZ    DEFAULT NOW()                              â”‚
â”‚     updated_at            TIMESTAMPTZ    DEFAULT NOW()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               ANALYTICS_EVENTS                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id                    UUID           DEFAULT uuid_generate_v4()                 â”‚
â”‚     event_type            VARCHAR(50)    NOT NULL                                   â”‚
â”‚     video_id              VARCHAR(100)                                              â”‚
â”‚     page                  VARCHAR(255)                                              â”‚
â”‚     user_agent            TEXT                                                      â”‚
â”‚     ip_address            VARCHAR(45)                                               â”‚
â”‚     metadata              JSONB                                                     â”‚
â”‚     created_at            TIMESTAMPTZ    DEFAULT NOW()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                CHAT_MESSAGES                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id                    UUID           DEFAULT uuid_generate_v4()                 â”‚
â”‚     session_id            VARCHAR(100)   NOT NULL                                   â”‚
â”‚     role                  VARCHAR(20)    NOT NULL (user, assistant)                 â”‚
â”‚     message               TEXT           NOT NULL                                   â”‚
â”‚     intent                VARCHAR(50)                                               â”‚
â”‚     confidence            DECIMAL(3,2)                                              â”‚
â”‚     created_at            TIMESTAMPTZ    DEFAULT NOW()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         1:N         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   BOOKINGS   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   PAYMENTS   â”‚
â”‚              â”‚                     â”‚              â”‚
â”‚ id (PK)      â”‚                     â”‚ booking_id   â”‚â”€â”€â”€â–º FK to bookings.id
â”‚              â”‚                     â”‚ (FK)         â”‚     ON DELETE SET NULL
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ANALYTICS_EVENTS â”‚                 â”‚  CHAT_MESSAGES   â”‚
â”‚                  â”‚                 â”‚                  â”‚
â”‚ (Standalone -    â”‚                 â”‚ (Session-based - â”‚
â”‚  no FK)          â”‚                 â”‚  no FK)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Table Descriptions

### 1. BOOKINGS
**Purpose:** Core business entity - stores all hibachi catering booking requests.

| Column Group | Description |
|--------------|-------------|
| **Identity** | UUID primary key + human-readable confirmation number (e.g., `CHF-ABC123`) |
| **Status** | Booking lifecycle status + payment status (separate concerns) |
| **Event Details** | When, where, and what type of venue |
| **Guest Details** | Party size, package selection, dietary requirements |
| **Contact** | Customer contact information |
| **Pricing** | Itemized pricing breakdown (base + addons + travel = total) |
| **Metadata** | Terms agreement, timestamps |

**Status Values:**
- `status`: `pending_payment`, `confirmed`, `fulfilled`, `cancelled`
- `payment_status`: `unpaid`, `deposit_paid`, `paid`, `refunded`, `failed`

### 2. PAYMENTS
**Purpose:** Stripe payment tracking - links PaymentIntents to bookings.

| Column | Description |
|--------|-------------|
| `payment_intent_id` | Stripe PaymentIntent ID (e.g., `pi_xxx`) |
| `booking_id` | Optional FK - null for orphaned payments |
| `amount` | Amount in cents (Stripe standard) |
| `status` | Mirrors Stripe status: `requires_payment`, `processing`, `succeeded`, `failed`, `refunded` |
| `payment_type` | `full` or `deposit` |
| `refund_id` | Stripe Refund ID if refunded |

### 3. ANALYTICS_EVENTS
**Purpose:** Track user behavior for business insights.

| Event Types | Description |
|-------------|-------------|
| `page_view` | User visited a page |
| `video_play` | User started playing a video |
| `video_complete` | User finished watching a video |
| `booking_start` | User began booking flow |
| `booking_complete` | User completed booking |
| `chat_interaction` | User engaged with chatbot |

### 4. CHAT_MESSAGES
**Purpose:** AI chatbot conversation history for context continuity.

| Column | Description |
|--------|-------------|
| `session_id` | Groups messages in a conversation |
| `role` | `user` or `assistant` |
| `intent` | Detected user intent (e.g., `pricing_inquiry`, `booking_help`) |
| `confidence` | AI confidence score (0.00 - 1.00) |

---

## Indexes

| Index Name | Table | Column(s) | Purpose |
|------------|-------|-----------|---------|
| `idx_bookings_email` | bookings | contact_email | Customer lookup |
| `idx_bookings_confirmation` | bookings | confirmation_number | Quick booking retrieval |
| `idx_bookings_date` | bookings | event_date | Date-based scheduling queries |
| `idx_bookings_status` | bookings | status | Filter by booking status |
| `idx_payments_booking` | payments | booking_id | Join payments to bookings |
| `idx_payments_intent` | payments | payment_intent_id | Stripe webhook lookup |
| `idx_analytics_event_type` | analytics_events | event_type | Filter by event type |
| `idx_analytics_created` | analytics_events | created_at | Time-series analytics |
| `idx_chat_session` | chat_messages | session_id | Retrieve conversation history |

---

## Constraints & Rules

### Primary Keys
- All tables use `UUID` primary keys with `uuid_generate_v4()` for distributed-safe ID generation

### Foreign Keys
- `payments.booking_id` â†’ `bookings.id` with `ON DELETE SET NULL` (preserve payment records if booking deleted)

### Unique Constraints
- `bookings.confirmation_number` - Human-readable booking reference
- `payments.payment_intent_id` - Stripe PaymentIntent ID

### Triggers
- `update_bookings_updated_at` - Auto-updates `updated_at` on row modification
- `update_payments_updated_at` - Auto-updates `updated_at` on row modification

---

## Data Types Reference

| PostgreSQL Type | Usage |
|-----------------|-------|
| `UUID` | Primary keys - globally unique, no collisions |
| `VARCHAR(n)` | Fixed-length strings (emails, names, IDs) |
| `TEXT` | Variable-length strings (addresses, notes) |
| `INTEGER` | Whole numbers (amounts in cents, counts) |
| `DECIMAL(10,2)` | Currency amounts in dollars |
| `DATE` | Event dates |
| `TIME` | Event times |
| `BOOLEAN` | True/false flags |
| `TIMESTAMPTZ` | Timestamps with timezone (UTC) |
| `JSONB` | Flexible metadata storage |

---

## Package Pricing Reference

| Package | Adult Price | Child Price |
|---------|-------------|-------------|
| Essential | $65 | $43 |
| Signature | $75 | $50 |
| Premium | $95 | $63 |

---

## State Machine: Booking Lifecycle

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ pending_payment â”‚ â—„â”€â”€ Initial state on creation
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              payment_intent.succeeded (webhook)
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    confirmed    â”‚ â—„â”€â”€ Payment received
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    Event completed
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    fulfilled    â”‚ â—„â”€â”€ Service delivered
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    At any point:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    cancelled    â”‚ â—„â”€â”€ Customer/admin cancellation
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Machine: Payment Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ requires_payment  â”‚ â—„â”€â”€ PaymentIntent created
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    Card submitted
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     3DS/Auth     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    processing     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  requires_action  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                      â”‚
    Payment confirmed                    Auth completed
          â”‚                                      â”‚
          â–¼                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    succeeded      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    Refund requested
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     refunded      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

On error at any step:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      failed       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Cloud Infrastructure

| Component | Service | Connection |
|-----------|---------|------------|
| **Database** | Cloud SQL (PostgreSQL) | `smiling-mark-476404-h0:us-west1:guangloindependent` |
| **Database Name** | `chefweb` | |
| **Backend** | Cloud Run | `chefweb-backend-775848565797.us-central1.run.app` |
| **Frontend** | GitHub Pages | `jimmy00415.github.io/ChefWeb/` |

---

## SQL Schema Location

Full schema file: [`Backend/src/db/schema.sql`](Backend/src/db/schema.sql)

Initialize with:
```bash
psql -d chefweb -f Backend/src/db/schema.sql
```

Or via API:
```bash
curl -X POST https://chefweb-backend-xxx.run.app/api/setup/init-db
```

---

*Last updated: January 29, 2026*

---

## Business Readiness Assessment

### âœ… READY (Complete)

| Feature | Status | Notes |
|---------|--------|-------|
| Frontend booking form | âœ… | Multi-step wizard with validation |
| Backend booking API | âœ… | Create, read, list bookings |
| PostgreSQL database | âœ… | Cloud SQL connected |
| Stripe payment integration | âœ… | SDK integrated, needs keys configured |
| Analytics dashboard API | âœ… | 7 endpoints for business insights |
| Billing reconciliation | âœ… | Payment sync + issue detection |
| Confirmation page | âœ… | Shows booking reference |
| Package pages | âœ… | Essential, Signature, Premium |
| Service areas page | âœ… | Geographic coverage display |
| FAQ page | âœ… | Common questions |
| Gallery page | âœ… | Photo showcase |
| Reviews page | âœ… | Customer testimonials |
| Mobile responsive | âœ… | CSS variables + responsive design |
| CORS configured | âœ… | Frontend â†” Backend connected |

### âŒ MISSING (Critical for Business)

| Feature | Priority | Impact | Effort |
|---------|----------|--------|--------|
| **Email Notifications** | ğŸ”´ CRITICAL | Customer doesn't receive confirmation | 2-3 hours |
| **Admin Dashboard** | ğŸ”´ CRITICAL | Can't manage bookings | 4-6 hours |
| **Contact Form Handler** | ğŸ”´ HIGH | Inquiries lost | 1 hour |
| **Booking Lookup** | ğŸŸ  HIGH | Customer can't check status | 1 hour |
| **Cancel/Modify Booking** | ğŸŸ  HIGH | No self-service | 2 hours |
| **Rate Limiting** | ğŸŸ  MEDIUM | API abuse protection | 1 hour |
| **AI Chatbot** | ğŸŸ¡ LOW | Basic responses only | 4+ hours |
| **Calendar Export** | ğŸŸ¡ LOW | No iCal/Google sync | 2 hours |
| **Error Logging** | ğŸŸ¢ LOW | Debugging harder | 1 hour |

### Minimum Viable Business (MVB) Checklist

To accept real customers, you NEED:

1. â¬œ **Email notifications** - Customer confirmation, admin alerts
2. â¬œ **Admin dashboard** - View/manage all bookings  
3. â¬œ **Contact form** - Handle inquiries
4. â¬œ **Stripe keys** - Real payment processing
